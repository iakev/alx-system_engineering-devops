#!/usr/bin/env bash
# Bash script to set up and configure HAproxy in server
## Install HAProxy
sudo apt-get install --no-install-recommends software-properties-common
sudo add-apt-repository ppa:vbernat/haproxy-2.6
sudo apt-get install -y haproxy=2.6.\*

## Configure HAProxy
sudo echo "#HAproxy server conf
frontend iakevdesign.tech

	 #set uo proxy mode to level 4 tcp/ip
	 mode tcp

	 #Recieve all IP addresses to listen on port 80
	 bind *:80

	 #choosing default backend servers
	 default_backend web_servers

backend web_servers
	mode tcp
	balance roundrobin
	server s1 18.204.5.6
	server s2 100.26.241.83
" | sudo tee -a  /etc/haproxy/haproxy.cfg > /dev/null
